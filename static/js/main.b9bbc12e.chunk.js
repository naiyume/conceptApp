(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n(15)},,,,,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(2),s=n.n(o),l=(n(12),n(3)),c=n(4),i=n(6),u=n(5),p=(n(13),n(14),function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).handleFileRead=function(e){var t=r.state.fileReader.result,n=r.readFile(t),a=document.createElement("a"),o=new Blob([r.state.excelOutput],{type:"text/plain"});a.href=URL.createObjectURL(o),a.download="myFile.csv",document.body.appendChild(a),a.click(),console.log(n),r.setState({JSONoutput:n})},r.handleCreateReverse=function(e){var t=r.reverseRead(r.state.textAreaValue);console.log(t);var n=document.createElement("a"),a=new Blob([t],{type:"text/plain"});n.href=URL.createObjectURL(a),n.download="myFile.csv",document.body.appendChild(n),n.click()},r.handleFileChosen=function(e){r.state.fileReader=new FileReader,r.state.fileReader.onloadend=r.handleFileRead,r.state.fileReader.readAsText(e)},r.getNumSpaces=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return 16*t+"px";t+=1}return 16*t+"px"},r.removeLeading=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return e.substring(t);t+=1}return e.substring(t)},r.handleChange=function(e){console.log(r.state.textAreaValue),r.setState({textAreaValue:e.target.value})},r.state={JSONoutput:[],fileReader:"",data:"",excelOutput:"",textAreaValue:""},r}return Object(c.a)(n,[{key:"reverseRead",value:function(e){Array.prototype.unique=function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e};for(var t=JSON.parse(e),n={},r=0;r<t.length;r++){n[t[r].conceptId]=r}for(var a=[],o=[],s=0;s<t.length;s++)for(var l=t[s],c=Object.keys(l),i=0;i<c.length;i++){var u=l[c[i]];if(c[i].includes("Source")&&(o.includes(s)||o.push(s)),Array.isArray(u)){for(var p=[],d=0;d<u.length;d++){var h=u[d];if(null!=h.match(/[0-9]{9}.json/)){var f=h.substring(0,9);p.push(t[n[f]]),a.includes(n[f])||a.push(n[f])}}p.length>0&&(l[c[i]]=p)}else if("string"==typeof u){if(null!=u.match(/[0-9]{9}.json/)){var g=u.substring(0,9);l[c[i]]=t[n[g]],a.includes(n[g])||a.push(n[g])}}else{for(var v=Object.keys(u),I={},m=0;m<v.length;m++)if(v[m].match(/[0-9]{9}.json/)){var y=v[m].substring(0,9);I[u[v[m]]]=t[n[y]],a.includes(n[y])||a.push(n[y])}Object.keys(u).length>0&&(l[c[i]]=I)}}for(var b=0;b<t.length;b++)a.includes(b)||o.includes(b)||o.push(b);for(var O=[],w=[],x=[],R=[],j=0;j<o.length;j++){var k=[t[o[j]].conceptId],S={};this.recurseRead(t[o[j]],S,"",k),O.push(S);for(var N=Object.keys(S),C=0,E=0;E<N.length;E++)w.includes(N[E])||x.includes(N[E])||(N[E].includes("conceptId")?x.push(N[E]):N[E].includes("subcollection")||N[E].includes("subcollections")||w.push(N[E])),S[N[E]].length>C&&(C=S[N[E]].length);R.push(C)}for(var P=!1,A=0;A<w.length;A++){for(var U=!1,V=0;V<x.length;V++)x[V].includes(w[A])&&(w.splice(A,0,x[V]),A+=1,V=x.length,U=!0);0==U&&0==P&&(w.splice(A,0,"conceptId"),A+=1,P=!0)}var J="";J+=w.map((function(e){return-1!=e.indexOf("conceptId")?"conceptId":-1!=e.indexOf(",")?'"'+e+'"':"0"==e?"":e})).join(",");for(var F=0;F<O.length;F++){for(var M=R[F],D=[],L=O[F],T=0;T<M;T++){for(var B=[],q=0;q<w.length;q++)B.push("");D.push(B)}for(var W=0;W<w.length;W++){var z=w[W];if(L.hasOwnProperty(z)){var $=L[z];if("0"!=z)for(var G=0;G<$.length;G++)D[G][W]=$[G]}}for(var H=0;H<D.length;H++)J+="\n",J+=D[H].map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(",")}return J}},{key:"recurseRead",value:function(e,t,n,r,a){var o=Object.keys(e);if(e.hasOwnProperty("conceptId")&&""!=n){var s=e.conceptId;if("subcollections"==n||"subcollection"==n){for(var l=-1,c=-1,i=0;i<o.length;i++)t.hasOwnProperty("conceptId"+o[i])&&""!=o[i]&&"subcollections"!=o[i]&&"subcollection"!=o[i]&&-1==l&&(l=i),o[i].includes("conceptId")||-1!=c||"subcollections"==o[i]||"subcollection"==o[i]||(c=i);var u="";u=-1==l?o[c]:o[l],t.hasOwnProperty("conceptId"+u)?t["conceptId"+u].includes(s)||t["conceptId"+u].push(s):t["conceptId"+u]=[s]}else t.hasOwnProperty("conceptId"+n)?t["conceptId"+n].includes(s)||t["conceptId"+n].push(s):t["conceptId"+n]=[s]}for(var p=0;p<o.length;p++){var d=e[o[p]];if(Array.isArray(d)){for(var h=[],f=0;f<d.length;f++)if("string"!=typeof d[f]&&!r.includes(d[f].conceptId)&&(r.push(d.conceptId),!n.includes("Source"))){var g=this.recurseRead(d[f],t,o[p],r);h.push(g)}}else if("string"==typeof d)"conceptId"!=o[p]&&"conceptId"!=n?""==n||"subcollection"==n?t.hasOwnProperty(o[p])?t[o[p]].includes(d)||t[o[p]].push(d):t[o[p]]=[d]:t.hasOwnProperty(n)?t[n].includes(d)||t[n].push(d):t[n]=[d]:"conceptId"==o[p]&&""==n&&(t.hasOwnProperty("conceptId"+n)?t["conceptId"+n].includes(d)||t["conceptId"+n].push(d):t["conceptId"+n]=[d]);else if(!d.hasOwnProperty("conceptId")||!r.includes(d.conceptId))if(d.hasOwnProperty("conceptId"))r.push(d.conceptId),this.recurseRead(d,t,o[p],r);else for(var v=Object.keys(d),I=0;I<v.length;I++)d[v[I]].hasOwnProperty("variableName")&&!d[v[I]].variableName.includes("=")&&(d[v[I]].variableName=v[I]+"="+d[v[I]].variableName),this.recurseRead(d[v[I]],t,o[p],r)}}},{key:"generateNine",value:function(){for(var e="",t=0;t<9;t++){e+=Math.floor(10*Math.random())}return e}},{key:"generateRandomUUID",value:function(e){for(var t=this.generateNine();!e.includes(t);){return this.generateNine()}}},{key:"processCluster",value:function(e,t,n,r,a,o,s,l){for(var c=[],i=Object.keys(o),u=[],p={},d=0;d<i.length;d++)u.push(parseInt(i[d])),p[o[i[d]]]=parseInt(i[d]);for(var h=1;h<e.length;h++)for(var f=e[h],g=0;g<f.length;g++)""==f[g].trim()||u.includes(g)||c.includes(g)||c.push(g);for(var v={},I=e[0],m=0;m<I.length;m++)""==I[m]||c.includes(m)||u.includes(m)||(v[t[m]]=I[m]);v.hasOwnProperty("conceptId")&&""!=v.conceptId||(n.hasOwnProperty(I[r])?(v.conceptId=n[I[r]],a.includes(v.conceptId)||a.push(v.conceptId)):(v.conceptId=this.generateRandomUUID(a),a.push(v.conceptId),n[I[r]]=v.conceptId)),I[p.thisRowId]=v.conceptId;for(var y=Object.keys(p),b=0;b<y.length;b++)if(-1!=y[b].indexOf("Source")){var O=I[p[y[b]]],w=I[p[y[b]]+1];""==O&&n.hasOwnProperty(w)&&(O=n[w]);for(var x=-1,R=0;R<s.length;R++){var j=s[R];""!=O&&j.conceptId==O?(x=b,j.subcollections.includes(v.conceptId+".json")||j.subcollections.push(v.conceptId+".json"),R=s.length):""==O&&w==j["Variable Name"]&&(x=b,O=j.conceptId,j.subcollections.includes(v.conceptId+".json")||j.subcollections.push(v.conceptId+".json"),R=s.length)}if(-1==x){var k={};""==O&&(O=this.generateRandomUUID(a)),k.conceptId=O,k["Variable Name"]=w,k.subcollections=[v.conceptId+".json"],s.push(k)}n[w]=O,a.includes(O)||a.push(O),v[t[p[y[b]]+1]]=O+".json",I[p[y[b]]]=O}for(var S=[],N=[],C=[],E=-1,P={},A=0;A<e.length;A++){for(var U={},V="",J=e[A],F=0;F<c.length;F++){var M=c[F],D=J[M];if(void 0==D)console.log("undefined: "+J),console.log(c),console.log(J.length);else if(-1!=D.indexOf("=")){V=D,E=M,C.push(D);var L=V.split("=")[1].trim(),T=V.split("=")[0].trim(),B=this.generateRandomUUID(a);n.hasOwnProperty(L)&&(B=n[L]),""!=J[E-1]&&(B=J[E-1]),l.push({conceptId:B,variableName:L}),n[L]=B,a.includes(B)||a.push(B),P[B+".json"]=T,J[E-1]=B}else""!=J[M]&&(U[t[M]]=J[M])}if(p.hasOwnProperty("leftMostId")&&""!=J[p.leftMostId]&&(U.conceptId=J[p.leftMostId]),0!=Object.keys(U).length){for(var q=this.generateRandomUUID(a),W=Object.keys(U),z=0;z<W.length;z++){var $=W[z];n.hasOwnProperty(U[$])&&(q=n[U[$]])}U.hasOwnProperty("conceptId")&&(q=U.conceptId),a.includes(q)||a.push(q),U.conceptId=q,N.push(q+".json");for(var G=0;G<W.length;G++){n[U[W[G]]]=q}S.push(U),e[A][p.leftMostId]=q}}if(0==S.length&&C.length>0)v[t[E]]=P;else{N.length>0&&(v.subcollection=N);for(var H=0;H<S.length;H++){var K=S[H];K[t[E]]=P,l.push(K)}}return""==e[0][p.thisRowId]?(v.conceptId=this.generateRandomUUID(a),n.hasOwnProperty(v[t[r]])&&(v.conceptId=n[v[t[r]]]),e[0][p.thisRowId]=v.conceptId,n[v[t[r]]]=v.conceptId):(v.conceptId=e[0][p.thisRowId],n[v[t[r]]]=v.conceptId),l.push(v),e}},{key:"CSVToArray",value:function(e){e=e.trim();for(var t=[];-1!=e.indexOf(",");){var n="";'"'==e.substring(0,1)?(n=(e=e.substring(1)).substring(0,e.indexOf('"')),e=(e=e.substring(e.indexOf('"')+1)).substring(e.indexOf(",")+1)):(n=e.substring(0,e.indexOf(",")),e=e.substring(e.indexOf(",")+1)),t.push(n)}return t.push(e),t}},{key:"lookForConcepts",value:function(e,t,n,r){for(var a=-1,o=[],s=1;s<e.length;s++)for(var l=e[s],c=0;c<l.length;c++)""!=l[c]&&(o.includes(c)||o.push(c),-1!=l[c].indexOf("=")&&(n.includes(c)||n.push(c),a=c));for(var i=0;i<o.length;i++)o[i]!=a&&o[i]<r[0]&&"conceptId"!=t[o[i]]&&(r[0]=o[i],r[1]=t[o[i]])}},{key:"getConceptIds",value:function(e){for(var t=0,n=[],r=!0,a=!1,o=[],s=[],l=[],c=[],i=[],u=-1,p=-1,d=e.split("\n"),h=0;h<d.length;h++){var f=d[h],g=this.CSVToArray(f,",");if(r){o=g,r=!1;for(var v=0;v<g.length;v++)"Variable Name"==g[v]&&(t=v),-1!=g[v].indexOf("Source")?s.push(v):-1!=g[v].indexOf("conceptId")?(c.push(v),l.push(g[v])):-1==p&&""!=g[v]&&(s.push(v),p=v);u=g.length,i.push(g.length),i.push("")}else a?""==g[t]?n.push(g):this.lookForConcepts(n,o,s,i):(n.push(g),a=!0)}this.lookForConcepts(n,o,s,i),s.includes(i[0])||i[0]==u||s.push(i[0]);for(var I=[],m=0;m<s.length;m++){for(var y=!1,b=0;b<c.length;b++)s[m]==c[b]+1&&(y=!0);0==y&&I.push(s[m])}I.sort((function(e,t){return t-e}));var O="";r=!0;var w={};d=e.split("\n");for(var x=0;x<d.length;x++){var R=d[x].split(",");if(1==r){for(var j=R[p],k=0;k<I.length;k++)R.splice(I[k],0,"conceptId");O+=R.map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),r=!1;for(var S=0;S<R.length;S++)R[S].includes("conceptId")&&S!=R.length-1&&(R[S+1]==j?w[S]="thisRowId":R[S+1]==i[1]?w[S]="leftMostId":w[S]=R[S+1])}else{for(var N=0;N<I.length;N++)R.splice(I[N],0,"");O+="\n",O+=R.map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(",")}}return this.state.data=O,w}},{key:"readFile",value:function(e){for(var t=[],n=[],r=JSON.parse("[]"),a=0,o=[],s=this.getConceptIds(e),l=[],c=!0,i=!1,u=[],p=JSON.parse("{}"),d=this.state.data.split("\n"),h=0;h<d.length;h++){var f=d[h],g=this.CSVToArray(f,",");if(c){u=g,c=!1;for(var v=0;v<g.length;v++)"Variable Name"==g[v]&&(a=v);l.push([g])}else if(i)if(""==g[a])o.push(g);else{var I=this.processCluster(o,u,p,a,r,s,n,t);l.push(I),o=[g],i=!0}else o.push(g),i=!0}var m=this.processCluster(o,u,p,a,r,s,n,t);l.push(m);for(var y=0;y<n.length;y++)t.push(n[y]);for(var b="",O=0;O<l.length;O++)for(var w=l[O],x=0;x<w.length;x++){w[x];b+=w[x].map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),O==l.length-1&&x==w.length-1||(b+="\n")}this.setState({excelOutput:b});for(var R=0;R<t.length;R++)JSON.stringify(t[R],null,"    ")+"\n";return t}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"App",style:{"text-align":"left"}},a.a.createElement("header",{className:"App-header",style:{"font-size":"16px","padding-top":"50px","padding-bottom":"50px"}},a.a.createElement("h2",null,"CSV to JSONS"),a.a.createElement("input",{type:"file",id:"file",className:"input-file",accept:".csv",onChange:function(t){return e.handleFileChosen(t.target.files[0])}}),a.a.createElement("div",{style:{"text-align":"center"}},a.a.createElement("p",null,"CSV Rules:"),a.a.createElement("p",null,"There must be a Variable Name field in every full row"),a.a.createElement("p",null,"The leaf nodes (final unit of response) is the only row that is allowed to have an equals sign")),a.a.createElement("div",{style:{"padding-left":"50px","padding-right":"50px"}},this.state.JSONoutput.map((function(t){return a.a.createElement("p",null,JSON.stringify(t,null,"-").split("\n").map((function(t){return a.a.createElement("span",{style:{"padding-left":e.getNumSpaces(t)}},e.removeLeading(t),a.a.createElement("br",null))})))}))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("h2",null,"JSONS to CSV"),a.a.createElement("p",null,"Enter a list of JSONS, and we will generate a csv file for it"),a.a.createElement("div",null,a.a.createElement("textarea",{value:this.state.textAreaValue,onChange:this.handleChange,rows:10,cols:50})),a.a.createElement("button",{type:"button",onClick:this.handleCreateReverse},"Convert!")))}}]),n}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.b9bbc12e.chunk.js.map