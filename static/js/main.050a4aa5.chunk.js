(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n(15)},,,,,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(2),o=n.n(a),i=(n(12),n(3)),l=n(4),c=n(6),u=n(5),p=(n(13),n(14),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).handleFileRead=function(e){var t=r.state.fileReader.result,n=r.readFile(t),s=document.createElement("a"),a=new Blob([r.state.excelOutput],{type:"text/plain"});s.href=URL.createObjectURL(a),s.download="myFile.csv",document.body.appendChild(s),s.click(),r.setState({JSONoutput:n})},r.handleFileChosen=function(e){r.state.fileReader=new FileReader,r.state.fileReader.onloadend=r.handleFileRead,r.state.fileReader.readAsText(e)},r.getNumSpaces=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return 16*t+"px";t+=1}return 16*t+"px"},r.removeLeading=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return e.substring(t);t+=1}return e.substring(t)},r.state={JSONoutput:[],fileReader:"",data:"",excelOutput:""},r}return Object(l.a)(n,[{key:"generateNine",value:function(){for(var e="",t=0;t<9;t++){e+=Math.floor(10*Math.random())}return e}},{key:"generateRandomUUID",value:function(e){for(var t=this.generateNine();!e.includes(t);){return this.generateNine()}}},{key:"processCluster",value:function(e,t,n,r,s,a,o,i){for(var l=[],c=Object.keys(a),u=[],p={},h=0;h<c.length;h++)u.push(parseInt(c[h])),p[a[c[h]]]=parseInt(c[h]);for(var d=1;d<e.length;d++)for(var f=e[d],g=0;g<f.length;g++)""==f[g]||u.includes(g)||l.includes(g)||l.push(g);for(var v={},I=e[0],m=0;m<I.length;m++)""==I[m]||l.includes(m)||u.includes(m)||(v[t[m]]=I[m]);v.hasOwnProperty("conceptId")&&""!=v.conceptId||(n.hasOwnProperty(I[r])?(v.conceptId=n[I[r]],s.includes(v.conceptId)||s.push(v.conceptId)):(v.conceptId=this.generateRandomUUID(s),s.push(v.conceptId),n[I[r]]=v.conceptId)),I[p.thisRowId]=v.conceptId;for(var O=Object.keys(p),b=0;b<O.length;b++)if(-1!=O[b].indexOf("Source")){var y=I[p[O[b]]],x=I[p[O[b]]+1];""==y&&n.hasOwnProperty(x)&&(y=n[x]);for(var w=-1,R=0;R<o.length;R++){var j=o[R];""!=y&&j.conceptId==y?(w=b,j.subcollections.includes(v.conceptId+".json")||j.subcollections.push(v.conceptId+".json"),R=o.length):""==y&&x==j["Variable Name"]&&(w=b,y=j.conceptId,j.subcollections.includes(v.conceptId+".json")||j.subcollections.push(v.conceptId+".json"),R=o.length)}if(-1==w){var k={};""==y&&(y=this.generateRandomUUID(s)),k.conceptId=y,k["Variable Name"]=x,k.subcollections=[v.conceptId+".json"],o.push(k)}n[x]=y,s.includes(y)||s.push(y),v[t[p[O[b]]+1]]=y+".json",I[p[O[b]]]=y}for(var N=[],S=[],C=[],U=-1,E={},F=0;F<e.length;F++){for(var J={},M="",P=e[F],V=0;V<l.length;V++){var A=l[V],D=P[A];if(-1!=D.indexOf("=")){M=D,U=A,C.push(D);var L=M.split("=")[1].trim(),T=M.split("=")[0].trim(),B=this.generateRandomUUID(s);n.hasOwnProperty(L)&&(B=n[L]),""!=P[U-1]&&(B=P[U-1]),i.push({conceptId:B,variableName:L}),n[L]=B,s.includes(B)||s.push(B),E[B+".json"]=T,P[U-1]=B}else""!=P[A]&&(J[t[A]]=P[A])}if(""!=P[p.leftMostId]&&(J.conceptId=P[p.leftMostId]),0!=Object.keys(J).length){for(var W=this.generateRandomUUID(s),z=Object.keys(J),$=0;$<z.length;$++){var q=z[$];n.hasOwnProperty(J[q])&&(W=n[J[q]])}J.hasOwnProperty("conceptId")&&(W=J.conceptId),s.includes(W)||s.push(W),J.conceptId=W,S.push(W+".json");for(var G=0;G<z.length;G++){n[J[z[G]]]=W}N.push(J),e[F][p.leftMostId]=W}}if(0==N.length&&C.length>0)v[t[U]]=E;else{v.subcollection=S;for(var H=0;H<N.length;H++){var K=N[H];K[t[U]]=E,i.push(K)}}return""==e[0][p.thisRowId]?(v.conceptId=this.generateRandomUUID(s),n.hasOwnProperty(v[t[r]])&&(v.conceptId=n[v[t[r]]]),e[0][p.thisRowId]=v.conceptId,n[v[t[r]]]=v.conceptId):(v.conceptId=e[0][p.thisRowId],n[v[t[r]]]=v.conceptId),i.push(v),e}},{key:"CSVToArray",value:function(e){for(var t=[];-1!=e.indexOf(",");){var n="";'"'==e.substring(0,1)?(n=(e=e.substring(1)).substring(0,e.indexOf('"')),e=(e=e.substring(e.indexOf('"')+1)).substring(e.indexOf(",")+1)):(n=e.substring(0,e.indexOf(",")),e=e.substring(e.indexOf(",")+1)),t.push(n)}return""!=e&&t.push(e),t}},{key:"lookForConcepts",value:function(e,t,n,r){for(var s=-1,a=[],o=1;o<e.length;o++)for(var i=e[o],l=0;l<i.length;l++)""!=i[l]&&(a.includes(l)||a.push(l),-1!=i[l].indexOf("=")&&(n.includes(l)||n.push(l),s=l));for(var c=0;c<a.length;c++)a[c]!=s&&a[c]<r[0]&&"conceptId"!=t[a[c]]&&(r[0]=a[c],r[1]=t[a[c]])}},{key:"getConceptIds",value:function(e){for(var t=0,n=[],r=!0,s=!1,a=[],o=[],i=[],l=[],c=[],u=-1,p=e.split("\n"),h=0;h<p.length;h++){var d=p[h],f=this.CSVToArray(d,",");if(r){a=f,r=!1;for(var g=0;g<f.length;g++)"Variable Name"==f[g]&&(t=g),-1!=f[g].indexOf("Source")?o.push(g):-1!=f[g].indexOf("conceptId")?(l.push(g),i.push(f[g])):-1==u&&""!=f[g]&&(o.push(g),u=g);c.push(f.length),c.push("")}else s?""==f[t]?n.push(f):this.lookForConcepts(n,a,o,c):(n.push(f),s=!0)}this.lookForConcepts(n,a,o,c),o.includes(c[0])||o.push(c[0]);for(var v=[],I=0;I<o.length;I++){for(var m=!1,O=0;O<l.length;O++)o[I]==l[O]+1&&(m=!0);0==m&&v.push(o[I])}v.sort((function(e,t){return t-e}));var b="";r=!0;var y={};p=e.split("\n");for(var x=0;x<p.length;x++){var w=p[x].split(",");if(1==r){for(var R=w[u],j=0;j<v.length;j++)w.splice(v[j],0,"conceptId");b+=w.join(","),r=!1;for(var k=0;k<w.length;k++)w[k].includes("conceptId")&&k!=w.length-1&&(w[k+1]==R?y[k]="thisRowId":w[k+1]==c[1]?y[k]="leftMostId":y[k]=w[k+1])}else{for(var N=0;N<v.length;N++)w.splice(v[N],0,"");b+="\n",b+=w.join(",")}}return this.state.data=b,y}},{key:"readFile",value:function(e){for(var t=[],n=[],r=JSON.parse("[]"),s=0,a=[],o=this.getConceptIds(e),i=[],l=!0,c=!1,u=[],p=JSON.parse("{}"),h=this.state.data.split("\n"),d=0;d<h.length;d++){var f=h[d],g=this.CSVToArray(f,",");if(l){u=g,l=!1;for(var v=0;v<g.length;v++)"Variable Name"==g[v]&&(s=v);i.push([g])}else if(c)if(""==g[s])a.push(g);else{var I=this.processCluster(a,u,p,s,r,o,n,t);i.push(I),a=[g],c=!0}else a.push(g),c=!0}var m=this.processCluster(a,u,p,s,r,o,n,t);i.push(m);for(var O=0;O<n.length;O++)t.push(n[O]);for(var b="",y=0;y<i.length;y++)for(var x=i[y],w=0;w<x.length;w++){x[w];b+=x[w].map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),y==i.length-1&&w==x.length-1||(b+="\n")}this.setState({excelOutput:b});for(var R=0;R<t.length;R++)JSON.stringify(t[R],null,"    ")+"\n";return t}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App",style:{"text-align":"left"}},s.a.createElement("header",{className:"App-header",style:{"font-size":"16px","padding-top":"50px","padding-bottom":"50px"}},s.a.createElement("input",{type:"file",id:"file",className:"input-file",accept:".csv",onChange:function(t){return e.handleFileChosen(t.target.files[0])}}),s.a.createElement("div",null),s.a.createElement("div",null,this.state.JSONoutput.map((function(t){return s.a.createElement("p",null,JSON.stringify(t,null,"-").split("\n").map((function(t){return s.a.createElement("span",{style:{"padding-left":e.getNumSpaces(t)}},e.removeLeading(t),s.a.createElement("br",null))})))})))))}}]),n}(s.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.050a4aa5.chunk.js.map