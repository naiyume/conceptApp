(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n(15)},,,,,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(2),s=n.n(o),l=(n(12),n(3)),i=n(4),c=n(6),u=n(5),p=(n(13),n(14),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).handleFileRead=function(e){var t=r.state.fileReader.result,n=r.readFile(t),a=document.createElement("a"),o=new Blob([r.state.excelOutput],{type:"text/plain"});a.href=URL.createObjectURL(o),a.download="myFile.csv",document.body.appendChild(a),a.click(),r.setState({JSONoutput:n})},r.handleFileChosen=function(e){r.state.fileReader=new FileReader,r.state.fileReader.onloadend=r.handleFileRead,r.state.fileReader.readAsText(e)},r.getNumSpaces=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return 16*t+"px";t+=1}return 16*t+"px"},r.removeLeading=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return e.substring(t);t+=1}return e.substring(t)},r.state={JSONoutput:[],fileReader:"",data:"",excelOutput:""},r}return Object(i.a)(n,[{key:"generateNine",value:function(){for(var e="",t=0;t<9;t++){e+=Math.floor(10*Math.random())}return e}},{key:"generateRandomUUID",value:function(e){for(var t=this.generateNine();!e.includes(t);){return this.generateNine()}}},{key:"processCluster",value:function(e,t,n,r,a,o,s,l){for(var i=[],c=Object.keys(o),u=[],p={},d=0;d<c.length;d++)u.push(parseInt(c[d])),p[o[c[d]]]=parseInt(c[d]);for(var h=1;h<e.length;h++)for(var f=e[h],g=0;g<f.length;g++)""==f[g].trim()||u.includes(g)||i.includes(g)||i.push(g);for(var v={},m=e[0],I=0;I<m.length;I++)""==m[I]||i.includes(I)||u.includes(I)||(v[t[I]]=m[I]);v.hasOwnProperty("conceptId")&&""!=v.conceptId||(n.hasOwnProperty(m[r])?(v.conceptId=n[m[r]],a.includes(v.conceptId)||a.push(v.conceptId)):(v.conceptId=this.generateRandomUUID(a),a.push(v.conceptId),n[m[r]]=v.conceptId)),m[p.thisRowId]=v.conceptId;for(var b=Object.keys(p),O=0;O<b.length;O++)if(-1!=b[O].indexOf("Source")){var y=m[p[b[O]]],w=m[p[b[O]]+1];""==y&&n.hasOwnProperty(w)&&(y=n[w]);for(var x=-1,R=0;R<s.length;R++){var N=s[R];""!=y&&N.conceptId==y?(x=O,N.subcollections.includes(v.conceptId+".json")||N.subcollections.push(v.conceptId+".json"),R=s.length):""==y&&w==N["Variable Name"]&&(x=O,y=N.conceptId,N.subcollections.includes(v.conceptId+".json")||N.subcollections.push(v.conceptId+".json"),R=s.length)}if(-1==x){var j={};""==y&&(y=this.generateRandomUUID(a)),j.conceptId=y,j["Variable Name"]=w,j.subcollections=[v.conceptId+".json"],s.push(j)}n[w]=y,a.includes(y)||a.push(y),v[t[p[b[O]]+1]]=y+".json",m[p[b[O]]]=y}for(var k=[],E=[],S=[],C=-1,U={},F=0;F<e.length;F++){for(var J={},V="",M=e[F],P=0;P<i.length;P++){var A=i[P],D=M[A];if(void 0==D)console.log("undefined: "+M),console.log(i),console.log(M.length);else if(-1!=D.indexOf("=")){V=D,C=A,S.push(D);var T=V.split("=")[1].trim(),L=V.split("=")[0].trim(),B=this.generateRandomUUID(a);n.hasOwnProperty(T)&&(B=n[T]),""!=M[C-1]&&(B=M[C-1]),l.push({conceptId:B,variableName:T}),n[T]=B,a.includes(B)||a.push(B),U[B+".json"]=L,M[C-1]=B}else""!=M[A]&&(J[t[A]]=M[A])}if(p.hasOwnProperty("leftMostId")&&""!=M[p.leftMostId]&&(J.conceptId=M[p.leftMostId]),0!=Object.keys(J).length){for(var W=this.generateRandomUUID(a),q=Object.keys(J),z=0;z<q.length;z++){var $=q[z];n.hasOwnProperty(J[$])&&(W=n[J[$]])}J.hasOwnProperty("conceptId")&&(W=J.conceptId),a.includes(W)||a.push(W),J.conceptId=W,E.push(W+".json");for(var G=0;G<q.length;G++){n[J[q[G]]]=W}k.push(J),e[F][p.leftMostId]=W}}if(0==k.length&&S.length>0)v[t[C]]=U;else{v.subcollection=E;for(var H=0;H<k.length;H++){var K=k[H];K[t[C]]=U,l.push(K)}}return""==e[0][p.thisRowId]?(v.conceptId=this.generateRandomUUID(a),n.hasOwnProperty(v[t[r]])&&(v.conceptId=n[v[t[r]]]),e[0][p.thisRowId]=v.conceptId,n[v[t[r]]]=v.conceptId):(v.conceptId=e[0][p.thisRowId],n[v[t[r]]]=v.conceptId),l.push(v),e}},{key:"CSVToArray",value:function(e){for(var t=[];-1!=e.indexOf(",");){var n="";'"'==e.substring(0,1)?(n=(e=e.substring(1)).substring(0,e.indexOf('"')),e=(e=e.substring(e.indexOf('"')+1)).substring(e.indexOf(",")+1)):(n=e.substring(0,e.indexOf(",")),e=e.substring(e.indexOf(",")+1)),t.push(n)}return t.push(e),t}},{key:"lookForConcepts",value:function(e,t,n,r){for(var a=-1,o=[],s=1;s<e.length;s++)for(var l=e[s],i=0;i<l.length;i++)""!=l[i]&&(o.includes(i)||o.push(i),-1!=l[i].indexOf("=")&&(n.includes(i)||n.push(i),a=i));for(var c=0;c<o.length;c++)o[c]!=a&&o[c]<r[0]&&"conceptId"!=t[o[c]]&&(r[0]=o[c],r[1]=t[o[c]])}},{key:"getConceptIds",value:function(e){for(var t=0,n=[],r=!0,a=!1,o=[],s=[],l=[],i=[],c=[],u=-1,p=-1,d=e.split("\n"),h=0;h<d.length;h++){var f=d[h],g=this.CSVToArray(f,",");if(r){o=g,r=!1;for(var v=0;v<g.length;v++)"Variable Name"==g[v]&&(t=v),-1!=g[v].indexOf("Source")?s.push(v):-1!=g[v].indexOf("conceptId")?(i.push(v),l.push(g[v])):-1==p&&""!=g[v]&&(s.push(v),p=v);u=g.length,c.push(g.length),c.push("")}else a?""==g[t]?n.push(g):this.lookForConcepts(n,o,s,c):(n.push(g),a=!0)}this.lookForConcepts(n,o,s,c),s.includes(c[0])||c[0]==u||s.push(c[0]);for(var m=[],I=0;I<s.length;I++){for(var b=!1,O=0;O<i.length;O++)s[I]==i[O]+1&&(b=!0);0==b&&m.push(s[I])}m.sort((function(e,t){return t-e}));var y="";r=!0;var w={};d=e.split("\n");for(var x=0;x<d.length;x++){var R=d[x].split(",");if(1==r){for(var N=R[p],j=0;j<m.length;j++)R.splice(m[j],0,"conceptId");y+=R.map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),r=!1;for(var k=0;k<R.length;k++)R[k].includes("conceptId")&&k!=R.length-1&&(R[k+1]==N?w[k]="thisRowId":R[k+1]==c[1]?w[k]="leftMostId":w[k]=R[k+1])}else{for(var E=0;E<m.length;E++)R.splice(m[E],0,"");y+="\n",y+=R.map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(",")}}return this.state.data=y,w}},{key:"readFile",value:function(e){for(var t=[],n=[],r=JSON.parse("[]"),a=0,o=[],s=this.getConceptIds(e),l=[],i=!0,c=!1,u=[],p=JSON.parse("{}"),d=this.state.data.split("\n"),h=0;h<d.length;h++){var f=d[h],g=this.CSVToArray(f,",");if(i){u=g,i=!1;for(var v=0;v<g.length;v++)"Variable Name"==g[v]&&(a=v);l.push([g])}else if(c)if(""==g[a])o.push(g);else{var m=this.processCluster(o,u,p,a,r,s,n,t);l.push(m),o=[g],c=!0}else o.push(g),c=!0}var I=this.processCluster(o,u,p,a,r,s,n,t);l.push(I);for(var b=0;b<n.length;b++)t.push(n[b]);for(var O="",y=0;y<l.length;y++)for(var w=l[y],x=0;x<w.length;x++){w[x];O+=w[x].map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),y==l.length-1&&x==w.length-1||(O+="\n")}this.setState({excelOutput:O});for(var R=0;R<t.length;R++)JSON.stringify(t[R],null,"    ")+"\n";return t}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"App",style:{"text-align":"left"}},a.a.createElement("header",{className:"App-header",style:{"font-size":"16px","padding-top":"50px","padding-bottom":"50px"}},a.a.createElement("input",{type:"file",id:"file",className:"input-file",accept:".csv",onChange:function(t){return e.handleFileChosen(t.target.files[0])}}),a.a.createElement("div",null),a.a.createElement("div",null,a.a.createElement("p",null,"CSV Rules:"),a.a.createElement("br",null),a.a.createElement("p",null,"There must be a Variable Name field in every full row"),a.a.createElement("br",null),a.a.createElement("p",null,"The leaf nodes (final unit of response) is the only row that is allowed to have an equals sign"),a.a.createElement("br",null)),a.a.createElement("div",null,this.state.JSONoutput.map((function(t){return a.a.createElement("p",null,JSON.stringify(t,null,"-").split("\n").map((function(t){return a.a.createElement("span",{style:{"padding-left":e.getNumSpaces(t)}},e.removeLeading(t),a.a.createElement("br",null))})))})))))}}]),n}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.71e47017.chunk.js.map