(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n(15)},,,,,function(e,t,n){},function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(2),o=n.n(s),l=(n(12),n(3)),c=n(4),i=n(6),u=n(5),p=(n(13),n(14),function(e){Object(i.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).handleFileRead=function(e){var t=r.state.fileReader.result,n=r.readFile(t),a=document.createElement("a"),s=new Blob([r.state.excelOutput],{type:"text/plain"});a.href=URL.createObjectURL(s),a.download="myFile.csv",document.body.appendChild(a),a.click(),console.log(JSON.stringify(n)),r.setState({JSONoutput:n})},r.handleCreateReverse=function(e){var t=r.reverseRead(r.state.textAreaValue);console.log(t);var n=document.createElement("a"),a=new Blob([t],{type:"text/plain"});n.href=URL.createObjectURL(a),n.download="myFile.csv",document.body.appendChild(n),n.click()},r.handleFileChosen=function(e){r.state.fileReader=new FileReader,r.state.fileReader.onloadend=r.handleFileRead,r.state.fileReader.readAsText(e)},r.getNumSpaces=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return 16*t+"px";t+=1}return 16*t+"px"},r.removeLeading=function(e){for(var t=0,n=0;n<e.length;n++){if("-"!=e.substring(n,n+1))return e.substring(t);t+=1}return e.substring(t)},r.handleChange=function(e){console.log(r.state.textAreaValue),r.setState({textAreaValue:e.target.value})},r.state={JSONoutput:[],fileReader:"",data:"",excelOutput:"",textAreaValue:""},r}return Object(c.a)(n,[{key:"reverseRead",value:function(e){Array.prototype.unique=function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e};for(var t=JSON.parse(e),n={},r=0;r<t.length;r++){n[t[r].conceptId]=r}for(var a=[],s=[],o=0;o<t.length;o++)for(var l=t[o],c=Object.keys(l),i=0;i<c.length;i++){var u=l[c[i]];if(c[i].includes("Source")&&(s.includes(o)||s.push(o)),Array.isArray(u)){for(var p=[],h=0;h<u.length;h++){var d=u[h];if(null!=d.match(/[0-9]{9}.json/)){var f=d.substring(0,9);p.push(t[n[f]]),a.includes(n[f])||a.push(n[f])}}p.length>0&&(l[c[i]]=p)}else if("string"==typeof u){if(null!=u.match(/[0-9]{9}.json/)){var v=u.substring(0,9);l[c[i]]=t[n[v]],a.includes(n[v])||a.push(n[v])}}else{for(var g=Object.keys(u),I={},m=0;m<g.length;m++)if(g[m].match(/[0-9]{9}.json/)){var y=g[m].substring(0,9);I[u[g[m]]]=t[n[y]],a.includes(n[y])||a.push(n[y])}Object.keys(u).length>0&&(l[c[i]]=I)}}for(var b=0;b<t.length;b++)a.includes(b)||s.includes(b)||s.push(b);for(var O=[],w=[],x=[],R=[],j=0;j<s.length;j++){var S=[t[s[j]].conceptId],k={};this.recurseRead(t[s[j]],k,"",S),O.push(k);for(var N=Object.keys(k),C=0,E=0;E<N.length;E++)w.includes(N[E])||x.includes(N[E])||(N[E].includes("conceptId")?x.push(N[E]):N[E].includes("subcollection")||N[E].includes("subcollections")||w.push(N[E])),k[N[E]].length>C&&(C=k[N[E]].length);R.push(C)}for(var P=!1,A=0;A<w.length;A++){for(var U=!1,V=0;V<x.length;V++)x[V].includes(w[A])&&(w.splice(A,0,x[V]),A+=1,V=x.length,U=!0);0==U&&0==P&&(w.splice(A,0,"conceptId"),A+=1,P=!0)}var J="";J+=w.map((function(e){return-1!=e.indexOf("conceptId")?"conceptId":-1!=e.indexOf(",")?'"'+e+'"':"0"==e?"":e})).join(",");for(var F=0;F<O.length;F++){for(var M=R[F],D=[],L=O[F],T=0;T<M;T++){for(var B=[],q=0;q<w.length;q++)B.push("");D.push(B)}for(var W=0;W<w.length;W++){var z=w[W];if(L.hasOwnProperty(z)){var $=L[z];if("0"!=z)for(var G=0;G<$.length;G++)D[G][W]=$[G]}}for(var H=0;H<D.length;H++)J+="\n",J+=D[H].map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(",")}return J}},{key:"recurseRead",value:function(e,t,n,r,a){var s=Object.keys(e);if(e.hasOwnProperty("conceptId")&&""!=n){var o=e.conceptId;if("subcollections"==n||"subcollection"==n){for(var l=-1,c=-1,i=0;i<s.length;i++)t.hasOwnProperty("conceptId"+s[i])&&""!=s[i]&&"subcollections"!=s[i]&&"subcollection"!=s[i]&&-1==l&&(l=i),s[i].includes("conceptId")||-1!=c||"subcollections"==s[i]||"subcollection"==s[i]||(c=i);var u="";u=-1==l?s[c]:s[l],t.hasOwnProperty("conceptId"+u)?t["conceptId"+u].includes(o)||t["conceptId"+u].push(o):t["conceptId"+u]=[o]}else t.hasOwnProperty("conceptId"+n)?t["conceptId"+n].includes(o)||t["conceptId"+n].push(o):t["conceptId"+n]=[o]}for(var p=0;p<s.length;p++){var h=e[s[p]];if(Array.isArray(h)){for(var d=[],f=0;f<h.length;f++)if("string"!=typeof h[f]&&!r.includes(h[f].conceptId)&&(r.push(h.conceptId),!n.includes("Source"))){var v=this.recurseRead(h[f],t,s[p],r);d.push(v)}}else if("string"==typeof h)"conceptId"!=s[p]&&"conceptId"!=n?""==n||"subcollection"==n?t.hasOwnProperty(s[p])?t[s[p]].includes(h)||t[s[p]].push(h):t[s[p]]=[h]:t.hasOwnProperty(n)?t[n].includes(h)||t[n].push(h):t[n]=[h]:"conceptId"==s[p]&&""==n&&(t.hasOwnProperty("conceptId"+n)?t["conceptId"+n].includes(h)||t["conceptId"+n].push(h):t["conceptId"+n]=[h]);else if(!h.hasOwnProperty("conceptId")||!r.includes(h.conceptId))if(h.hasOwnProperty("conceptId"))r.push(h.conceptId),this.recurseRead(h,t,s[p],r);else for(var g=Object.keys(h),I=0;I<g.length;I++)h[g[I]].hasOwnProperty("variableName")&&!h[g[I]].variableName.includes("=")&&(h[g[I]].variableName=g[I]+"="+h[g[I]].variableName),this.recurseRead(h[g[I]],t,s[p],r)}}},{key:"generateNine",value:function(){for(var e="",t=0;t<9;t++){e+=Math.floor(10*Math.random())}return e}},{key:"generateRandomUUID",value:function(e){for(var t=this.generateNine();!e.includes(t);){return this.generateNine()}}},{key:"processCluster",value:function(e,t,n,r,a,s,o,l){for(var c=[],i=Object.keys(s),u=[],p={},h=0;h<i.length;h++)u.push(parseInt(i[h])),p[s[i[h]]]=parseInt(i[h]);for(var d=1;d<e.length;d++)for(var f=e[d],v=0;v<f.length;v++)""==f[v].trim()||u.includes(v)||c.includes(v)||c.push(v);for(var g={},I=e[0],m=0;m<I.length;m++)""==I[m]||c.includes(m)||u.includes(m)||(g[t[m]]=I[m]);g.hasOwnProperty("conceptId")&&""!=g.conceptId||(n.hasOwnProperty(I[r])?(g.conceptId=n[I[r]],a.includes(g.conceptId)||a.push(g.conceptId)):(g.conceptId=this.generateRandomUUID(a),a.push(g.conceptId),n[I[r]]=g.conceptId)),I[p.thisRowId]=g.conceptId;for(var y=Object.keys(p),b=0;b<y.length;b++)if(-1!=y[b].indexOf("Source")){var O=I[p[y[b]]],w=I[p[y[b]]+1];""==O&&n.hasOwnProperty(w)&&(O=n[w]);for(var x=-1,R=0;R<o.length;R++){var j=o[R];""!=O&&j.conceptId==O?(x=b,j.subcollections.includes(g.conceptId+".json")||j.subcollections.push(g.conceptId+".json"),R=o.length):""==O&&w==j["Variable Name"]&&(x=b,O=j.conceptId,j.subcollections.includes(g.conceptId+".json")||j.subcollections.push(g.conceptId+".json"),R=o.length)}if(-1==x){var S={};""==O&&(O=this.generateRandomUUID(a)),S.conceptId=O,S["Variable Name"]=w,S.subcollections=[g.conceptId+".json"],o.push(S)}n[w]=O,a.includes(O)||a.push(O),g[t[p[y[b]]+1]]=O+".json",I[p[y[b]]]=O}for(var k=[],N=[],C=[],E=-1,P={},A=0;A<e.length;A++){for(var U={},V="",J=e[A],F=0;F<c.length;F++){var M=c[F],D=J[M];if(void 0==D);else if(-1!=D.indexOf("=")){V=D,E=M,C.push(D);var L=V.split("=")[1].trim(),T=V.split("=")[0].trim(),B=this.generateRandomUUID(a);n.hasOwnProperty(L)&&(B=n[L]),""!=J[E-1]&&(B=J[E-1]),l.push({conceptId:B,variableName:L}),n[L]=B,a.includes(B)||a.push(B),P[B+".json"]=T,J[E-1]=B}else""!=J[M]&&(U[t[M]]=J[M])}if(p.hasOwnProperty("leftMostId")&&""!=J[p.leftMostId]&&(U.conceptId=J[p.leftMostId]),0!=Object.keys(U).length){for(var q=this.generateRandomUUID(a),W=Object.keys(U),z=0;z<W.length;z++){var $=W[z];n.hasOwnProperty(U[$])&&(q=n[U[$]])}U.hasOwnProperty("conceptId")&&(q=U.conceptId),a.includes(q)||a.push(q),U.conceptId=q,N.push(q+".json");for(var G=0;G<W.length;G++){n[U[W[G]]]=q}k.push(U),e[A][p.leftMostId]=q}}if(0==k.length&&C.length>0)g[t[E]]=P;else{N.length>0&&(g.subcollection=N);for(var H=0;H<k.length;H++){var K=k[H];K[t[E]]=P,l.push(K)}}return""==e[0][p.thisRowId]?(g.conceptId=this.generateRandomUUID(a),n.hasOwnProperty(g[t[r]])&&(g.conceptId=n[g[t[r]]]),e[0][p.thisRowId]=g.conceptId,n[g[t[r]]]=g.conceptId):(g.conceptId=e[0][p.thisRowId],n[g[t[r]]]=g.conceptId),l.push(g),e}},{key:"CSVToArray",value:function(e){e=e.trim();for(var t=[];-1!=e.indexOf(",");){var n="";'"'==e.substring(0,1)?(n=(e=e.substring(1)).substring(0,e.indexOf('"')),e=(e=e.substring(e.indexOf('"')+1)).substring(e.indexOf(",")+1)):(n=e.substring(0,e.indexOf(",")),e=e.substring(e.indexOf(",")+1)),t.push(n)}return t.push(e),t}},{key:"lookForConcepts",value:function(e,t,n,r){for(var a=-1,s=[],o=1;o<e.length;o++)for(var l=e[o],c=0;c<l.length;c++)""!=l[c]&&(s.includes(c)||s.push(c),-1!=l[c].indexOf("=")&&(n.includes(c)||n.push(c),a=c));for(var i=0;i<s.length;i++)s[i]!=a&&s[i]<r[0]&&"conceptId"!=t[s[i]]&&(r[0]=s[i],r[1]=t[s[i]])}},{key:"getConceptIds",value:function(e){for(var t=0,n=[],r=!0,a=!1,s=[],o=[],l=[],c=[],i=[],u=-1,p=-1,h=e.split("\n"),d=0;d<h.length;d++){var f=h[d],v=this.CSVToArray(f,",");if(r){s=v,r=!1;for(var g=0;g<v.length;g++)"Variable Name"==v[g]&&(t=g),-1!=v[g].indexOf("Source")?o.push(g):-1!=v[g].indexOf("conceptId")?(c.push(g),l.push(v[g])):-1==p&&""!=v[g]&&(o.push(g),p=g);u=v.length,i.push(v.length),i.push("")}else a?""==v[t]?n.push(v):this.lookForConcepts(n,s,o,i):(n.push(v),a=!0)}this.lookForConcepts(n,s,o,i),o.includes(i[0])||i[0]==u||o.push(i[0]);for(var I=[],m=0;m<o.length;m++){for(var y=!1,b=0;b<c.length;b++)o[m]==c[b]+1&&(y=!0);0==y&&I.push(o[m])}I.sort((function(e,t){return t-e}));var O="";r=!0;var w={};h=e.split("\n");for(var x=0;x<h.length;x++){var R=h[x].split(",");if(1==r){for(var j=R[p],S=0;S<I.length;S++)R.splice(I[S],0,"conceptId");O+=R.map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),r=!1;for(var k=0;k<R.length;k++)R[k].includes("conceptId")&&k!=R.length-1&&(R[k+1]==j?w[k]="thisRowId":R[k+1]==i[1]?w[k]="leftMostId":w[k]=R[k+1])}else{for(var N=0;N<I.length;N++)R.splice(I[N],0,"");O+="\n",O+=R.map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(",")}}return this.state.data=O,w}},{key:"readFile",value:function(e){for(var t=[],n=[],r=JSON.parse("[]"),a=0,s=[],o=this.getConceptIds(e),l=[],c=!0,i=!1,u=[],p=JSON.parse("{}"),h=this.state.data.split("\n"),d=0;d<h.length;d++){var f=h[d],v=this.CSVToArray(f,",");if(c){u=v,c=!1;for(var g=0;g<v.length;g++)"Variable Name"==v[g]&&(a=g);l.push([v])}else if(i)if(""==v[a])s.push(v);else{var I=this.processCluster(s,u,p,a,r,o,n,t);l.push(I),s=[v],i=!0}else s.push(v),i=!0}var m=this.processCluster(s,u,p,a,r,o,n,t);l.push(m);for(var y=0;y<n.length;y++)t.push(n[y]);for(var b="",O=0;O<l.length;O++)for(var w=l[O],x=0;x<w.length;x++){w[x];b+=w[x].map((function(e){return-1!=e.indexOf(",")?'"'+e+'"':e})).join(","),O==l.length-1&&x==w.length-1||(b+="\n")}this.setState({excelOutput:b});for(var R=0;R<t.length;R++)JSON.stringify(t[R],null,"    ")+"\n";return t}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"App",style:{"text-align":"left"}},a.a.createElement("header",{className:"App-header",style:{"font-size":"16px","padding-top":"50px","padding-bottom":"50px"}},a.a.createElement("h2",null,"CSV to JSONS"),a.a.createElement("input",{type:"file",id:"file",className:"input-file",accept:".csv",onChange:function(t){return e.handleFileChosen(t.target.files[0])}}),a.a.createElement("div",{style:{"text-align":"center"}},a.a.createElement("p",null,"CSV Rules:"),a.a.createElement("p",null,"There must be a Variable Name field in every full row"),a.a.createElement("p",null,"The leaf nodes (final unit of response) is the only row that is allowed to have an equals sign")),a.a.createElement("div",{style:{"padding-left":"50px","padding-right":"50px"}},this.state.JSONoutput.map((function(t){return a.a.createElement("p",null,JSON.stringify(t,null,"-").split("\n").map((function(t){return a.a.createElement("span",{style:{"padding-left":e.getNumSpaces(t)}},e.removeLeading(t),a.a.createElement("br",null))})))}))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement("h2",null,"JSONS to CSV"),a.a.createElement("p",null,"Enter a list of JSONS, and we will generate a csv file for it"),a.a.createElement("div",null,a.a.createElement("textarea",{value:this.state.textAreaValue,onChange:this.handleChange,rows:10,cols:50})),a.a.createElement("button",{type:"button",onClick:this.handleCreateReverse},"Convert!")))}}]),n}(a.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.07f00069.chunk.js.map